<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ENT Internal App</title>
<style>
:root{
 --light-red:#ffb3b3;
 --wine:#7b1e2b;
 --white:#ffffff;
}
*{box-sizing:border-box;font-family:system-ui, sans-serif;}
body{margin:0;background:var(--light-red);}

#loginScreen{
position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
background:linear-gradient(135deg,var(--light-red),var(--wine));
}

.login-box{
background:white;
padding:24px;
width:90%;
max-width:360px;
border-radius:18px;
box-shadow:0 10px 30px rgba(0,0,0,.2);
animation:pop .6s ease;
}

@keyframes pop{
from{transform:scale(.8);opacity:0}
to{transform:scale(1);opacity:1}
}

.login-box h2{text-align:center;color:var(--wine)}
.login-box input,select{
width:100%;
padding:12px;
margin:8px 0;
border-radius:10px;
border:1px solid #ddd;
}
.login-box button{
width:100%;
padding:12px;
border:none;
border-radius:12px;
background:var(--wine);
color:white;
font-weight:bold;
}

#app{display:none;height:100vh;display:flex;flex-direction:column;}

header{
background:var(--wine);
color:white;
padding:14px;
text-align:center;
font-weight:bold;
}

nav{
display:flex;
background:white;
}
nav button{
flex:1;
padding:10px;
border:none;
background:white;
}
nav button.active{background:var(--light-red)}

section{flex:1;overflow:auto;padding:12px;display:none;}
section.active{display:block}

.chat-box{display:flex;flex-direction:column;gap:8px}

.bubble{
max-width:70%;
padding:10px 12px;
border-radius:16px;
animation:fade .3s ease;
}

@keyframes fade{from{opacity:0;transform:translateY(10px)}to{opacity:1}}

.me{align-self:flex-end;background:var(--wine);color:white}
.other{align-self:flex-start;background:white;border:1px solid #ddd}

.input-bar{display:flex;gap:6px;margin-top:8px}
.input-bar input{flex:1;padding:10px;border-radius:10px;border:1px solid #ccc}
.input-bar button{padding:10px;border:none;border-radius:10px;background:var(--wine);color:white}

.post{
background:white;
border-radius:12px;
padding:12px;
margin-bottom:10px;
animation:fade .3s ease;
}

.file-item{
background:white;
padding:10px;
border-radius:10px;
margin-bottom:8px;
display:flex;
justify-content:space-between;
}

.badge{
font-size:12px;
background:var(--light-red);
padding:3px 6px;
border-radius:6px;
} </style>

</head>
<body>

<!-- LOGIN -->

<div id="loginScreen">
 <div class="login-box">
  <h2>ENT LOGIN</h2>
  <input id="name" placeholder="이름">
  <input id="code" placeholder="접속 코드" type="password">
  <select id="role">
    <option value="trainee">연습생</option>
    <option value="artist">아티스트</option>
    <option value="manager">매니저</option>
    <option value="admin">관리자</option>
  </select>
  <button id="loginBtn" type="button">로그인</button>
 </div>
</div>

<!-- APP -->

<div id="app">
<header id="topTitle"></header>

<nav>
 <button onclick="openTab('chat')" class="active">채팅</button>
 <button onclick="openTab('board')">커뮤니티</button>
 <button onclick="openTab('diary')">일기</button>
 <button onclick="openTab('files')">자료실</button>
</nav>

<section id="chat" class="active">
 <div class="chat-box" id="chatBox"></div>
 <div class="input-bar">
  <input id="chatInput" placeholder="메시지 입력">
  <button onclick="sendChat()">전송</button>
 </div>
</section>

<section id="board">
 <div id="postList"></div>
 <input id="postInput" placeholder="글 작성">
 <button onclick="addPost()">등록</button>
</section>

<section id="diary">
 <textarea id="diaryText" style="width:100%;height:70%"></textarea>
 <button onclick="saveDiary()">저장</button>
</section>

<section id="files">
 <input type="file" id="fileInput">
 <button onclick="uploadFile()">업로드</button>
 <div id="fileList"></div>
</section>
</div>

<script>
let currentUser=null;
let currentRole=null;

const loginBtn=document.getElementById('loginBtn');
const nameInput=document.getElementById('name');
const codeInput=document.getElementById('code');
const roleInput=document.getElementById('role');

loginBtn.onclick=(e)=>{
 e.preventDefault();

 const username=nameInput.value.trim();
 const access=codeInput.value.trim();
 const role=roleInput.value;

 if(!username){alert('이름을 입력하세요');return;}
 if(access!=='12345'){alert('접속 코드 오류');return;}

 currentUser=username;
 currentRole=role;

 localStorage.setItem('user',username);
 localStorage.setItem('role',role);

 document.getElementById('loginScreen').style.display='none';
 document.getElementById('app').style.display='flex';

 document.getElementById('topTitle').innerText=`${username} (${role})`;
 loadDiary();
 loadPosts();
 loadFiles();
}

function openTab(id){
 document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
 document.getElementById(id).classList.add('active');
 document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
 event.target.classList.add('active');
}

// CHAT
function sendChat(){
 const input=document.getElementById('chatInput');
 const msg=input.value.trim();
 if(!msg)return;

 const box=document.createElement('div');
 box.className='bubble me';
 box.innerText=msg;
 document.getElementById('chatBox').appendChild(box);
 input.value='';
}

// COMMUNITY
function addPost(){
 const text=document.getElementById('postInput').value.trim();
 if(!text)return;
 const posts=JSON.parse(localStorage.getItem('posts')||'[]');
 posts.push({user:currentUser,text});
 localStorage.setItem('posts',JSON.stringify(posts));
 document.getElementById('postInput').value='';
 loadPosts();
}

function loadPosts(){
 const list=document.getElementById('postList');
 list.innerHTML='';
 const posts=JSON.parse(localStorage.getItem('posts')||'[]');
 posts.forEach(p=>{
  const div=document.createElement('div');
  div.className='post';
  div.innerHTML=`<b>${p.user}</b><br>${p.text}`;
  list.appendChild(div);
 });
}

// DIARY
function saveDiary(){
 localStorage.setItem('diary_'+currentUser,document.getElementById('diaryText').value);
 alert('저장 완료');
}

function loadDiary(){
 document.getElementById('diaryText').value=localStorage.getItem('diary_'+currentUser)||'';
}

// FILE BOARD
function uploadFile(){
 const file=document.getElementById('fileInput').files[0];
 if(!file)return;
 const files=JSON.parse(localStorage.getItem('files')||'[]');
 files.push({name:file.name,by:currentUser});
 localStorage.setItem('files',JSON.stringify(files));
 loadFiles();
}

function loadFiles(){
 const list=document.getElementById('fileList');
 list.innerHTML='';
 const files=JSON.parse(localStorage.getItem('files')||'[]');
 files.forEach(f=>{
  const div=document.createElement('div');
  div.className='file-item';
  div.innerHTML=`${f.name} <span class='badge'>${f.by}</span>`;
  list.appendChild(div);
 });
}

// AUTO LOGIN
window.onload=()=>{
 const saved=localStorage.getItem('user');
 const role=localStorage.getItem('role');
 if(saved){
  currentUser=saved;
  currentRole=role;
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('app').style.display='flex';
  document.getElementById('topTitle').innerText=`${saved} (${role})`;
  loadDiary();
  loadPosts();
  loadFiles();
 }
}
</script>

</body>
</html>

